第7章 数理モデル

モデリングの哲学
自分たちが何をしようとしているか、なぜしようとしているかを考えれば利点がある。
モデル構築の方法論を形成するためにモデルについて考え方に触れる

オッカムの剃刀
オッカムの剃刀とは最もよい説明は最も単純な説明という哲学的な原則のこと
同じくらい正確な予測ができる2つのモデルがあるときは単純なものの方が合理的。
単純とは一般的にモデルの開発において前提の数を減らすことを指す。
ただし正確度と単純性は本質的にトレードオフ。

バイアス-バリアンストレードオフ
バイアス：モデルに組み込まれた間違った前提に起因する誤差
バリアンス：訓練セット内のノイズに対する感度に起因する誤差
バイアスの誤差はアンダーフィッティングのモデルを作り出す

ネイトシルバーならどうするか
ネイトシルバーは著書の中で効果的なモデリングの原則として次のようなことを挙げる
・確率論的に考える
・新しい情報に反応して予測を変える
・一致を追求する
・ベイズ推論を取り入れる

モデルの用語
線形モデルと非線形モデル
線形モデルは個々の特徴変数にその重みを反映した係数を掛け得られた値を合計してスコアを出すという式
非線形モデルの最良の係数を探し出すのは線形モデルの場合よりも難しい。

ブラックボックスモデルと記述的モデル
ブラックボックスとは与えられた仕事をする装置ではあるものの
そのやり方がよくわからないものを指す。
それと対称的に自分がなぜそのような判断を下すかを説明するのが記述的なモデル。

第一原理モデルとデータ駆動型モデル
第一原理モデルは作りたいシステムがどのような仕組みで動作するかがしっかり把握できているモデル
データ駆動型モデルは入力パラメータと結果変数の間で観察された相関に基づいている
アドホックモデルは専門分野の内部で通用している知識を使って作られる。

確率論的モデルと決定論的モデル
確率論的＝でらために決まるということをもっともらしい響きにした言葉
確率の基本性質は以下
・確率は0と1の間で値である
・確率の合計は1にならなければならない
・まれな事象でも確率0にはならない

フラットモデルと階層化モデル
モデルに階層をつける＝階層化モデル
→モデルをブラックボックス化せず論理的で透明な方法で構築、評価できる
ディープラーニングモデルは同時にフラットモデルでも階層化モデルでもあると考えられる。

ベースラインモデル
タスクの複雑度を評価するためにはベースラインモデルを作る。
ベースラインモデルとは答えを出すことができる合理的なモデルの中で最も単純なもので
モデルの性能を測る基準となる。

分類問題のベースラインモデル
データサイエンスモデルのタスクは一般に分類と値予測
分類タスクの代表的なベースラインモデルは以下
・特定のラベルやランダムなラベルの選択
・訓練データセットで最も多くの要素が属しているラベル
・最も正確なシングル特徴モデル
・第三者のモデル
・理想の予測器

値予測問題のベースラインモデル
値予測問題でも以下のようにベースラインモデルを作る
・平均または中央値
・線形回帰
・前の時刻の値

モデルの評価
分類問題または値予測モデルを構築してもその性能がどのくらいかの問題に単純な答えはない。
モデル評価の最も重要な基準は簡易のスニッフテスト。
スニッフテストとはモデルが正解を出した少数の事例ちモデルが間違った事例をじっくりと見る手法
目標はモデルがなぜその結果にたどり着いたかを理解すること

分類器の評価
分類器の評価とは評価セットのデータに対して予測したラベルが実際のラベルと
どの程度一致しているかを測定すること。
ラベルとクラスが2種類あるという一般的な条件では要素が少なく重要だと思う方を陽性、
そうでない方を陰性と呼ぶ
特定事例に対する分類のモデルの処理結果は4種類ある。
・真陽性：分類器が陽性クラスの事例を正しく陽性に分類した場合
・真陰性：分類器が陰性クラスの事例を正しく陰性に分類した場合
・偽陽性：分類器が陰性クラスを陽性に分類した場合
・偽陰性：分類器が陽性クラスを陰性に分類した場合

真/偽、陽性/陰性の数から計算される数種類の評価統計量がある。
評価統計量が何種類もあるのは自明な評価器となるシャープとモンキーという2種類のベースライン
よりも優れていることを示すため
シャープ：我々が使っている評価システムをしっていてその知識から考えて最も優れたベースラインモデルを選択する。
使い物にならない分類器で高いスコアを叩き出して我々の分類器の評価統計量を悪く見せようとする
モンキー：個々の事例のクラスをランダムに答える。

ROC曲線
ROC曲線は分類器に組み込むことのできる選択の範囲全体を可視化する。
この曲線の上の点はそれぞれ真陽性率と偽陽性率という形で分類器の特定の閾値を表す。

マルチクラス分類器の評価
分類問題の多くはラベルが2つだけではない。
クラスのラベルが増えれば増えるほど正しい分類は難しくなる。
d種類のラベルを持つ分類でモンキーに期待できる正確度は1/dとなる。
→そのためマルチクラス分類器の評価は難しい
マルチタスク分類器の評価はk≧1といった特定の値までの正確度を一般化したトップk成功率の方が統計指標として優れている。
混同行列Cはさらに強力な評価ツール。

値予測モデルの評価
誤差の統計
統計の場合、誤差とは予測y'＝f(x)と実際の結果yの差を返す関数。
個別誤差関数の主な選択肢としては以下
・絶対誤差
・相対誤差
・二乗誤差
値予測器の絶対誤差の分布をヒストグラムにすると誤差の分布が学べる。

評価システム
評価システムの構築を行うために単一命令のプログラムが必要。
単一命令のプログラムである必要性として回数をこなすため。
優れた評価システムの特徴は以下
・二値の結果だけでなく誤差分布を生成する
・自動的に複数の入力分布についての複数のグラフを作る
・品質を素早く評価できるように性能をよく示す基本統計量を出力する。

評価のためのデータの健全性
予測モデルを構築するという目的でデータセットを入手したときにはまず
入力を次の3つの部分に分割する
・訓練データ
・検証データ
・テストデータ

小規模な評価セットの拡張
入力を厳格に訓練、テスト、評価に分割するには大規模なデータセットである必要がある。
ただしデータセットが足りない場合にはデータセットを増やす方法がある。
・もとの分布から否定例を作る
・本物の事例を操作してよく似た合成事例を作る
・可能なら自己評価を追加する

シミュレーションモデル
第一原理モデルにはデータ駆動型モデルではないが、多様性の幅が広い現象を理解するために
シミュレーションモデルというものがある。
モンテカルロシミュレーションは乱数を使って仮想的に構成する。
効果的なモンテカルロシミュレーションを作れるかは離散事象モデルを適切に作られるか
